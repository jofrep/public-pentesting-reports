use warnings;
use strict;

my $header = "# Public penetration testing reports

Curated list of public penetration testing reports released by several consulting firms.\n";
my $footer = "";

my $root = ".";
my $subdir = "";
my $baseurl = ".";
my $name = "";
my $url = "";

opendir my $dh, $root
  or die "$0: opendir: $!";

print $header;

while (defined(my $dir = readdir $dh)) {
	if ($dir =~ /^\./){next};    
  if ($dir =~ /\.pl$/){next};
  if ($dir =~ /\.md$/){next};
  
  print "### $dir\n\n";
  
  $subdir = $root."/".$dir;
  opendir my $dhh, $subdir
  or die "$0: opendir: $!";
  
  while (defined(my $file = readdir $dhh)) {
	  if ($file =~ /^\./){next}; 
	  $name = $file;  
	  $name =~ s/_/ /g;
	  $url = $baseurl."/".$dir."/".$file;
    print " * [$name]($url)\n";
  }
  print "\n";
}

print $footer;